<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‚ô† ACRO HOLD 'EM ‚ô†</title>
  <style>
    :root{font-family:Inter,system-ui,Segoe UI,Roboto,'Noto Sans KR',sans-serif}
    body {
      margin: 0;
      padding: 8px;
      overflow-x: hidden;
      background-image: url('https://raw.githubusercontent.com/angol99/acro/main/acro.webp');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      opacity: 0.95;
    }
    .container {
      max-width: 760px;
      margin: 0 auto;
      background: #fff;
      padding: 8px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(16, 24, 40, 0.08);
      overflow-x: auto; /* tableÏù¥ ÎÑòÏπ† Í≤ΩÏö∞ ÎåÄÏùë */
    }

    /*
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('https://raw.githubusercontent.com/angol99/acro/main/acro.webp');
      background-size: cover;
      background-position: center;
      opacity: 0.95;
      z-index: -1;
    }
    */
    .container{max-width:760px;margin:0 auto;background:#fff;padding:8px;border-radius:12px;box-shadow:0 6px 20px rgba(16,24,40,.08)}
    h1{font-size:20px;margin:0 0 12px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px 10px;text-align:left}
    thead th{font-weight:600;border-bottom:1px solid #e6eef6}
    tbody tr:nth-child(odd){background:#fbfdff}
    input[type=number]{width:90%;padding:6px 8px;border:1px solid #dbe7f5;border-radius:8px;font-size:14px}
    .mult{font-weight:700}
    .hint{font-size:13px;color:#6b7280;margin-top:10px}
    .row-flex{display:flex;gap:12px;align-items:center}
    .small{font-size:13px;color:#6b7280}
    footer{margin-top:16px;text-align:right}
    button{padding:8px 12px;border-radius:8px;border:0;background:#2563eb;color:white;cursor:pointer}
    button:active{transform:translateY(1px)}
    tfoot td{font-weight:bold;border-top:2px solid #ccc}
  </style>
</head>
<body>
  <div class="container">
    <table>
      <thead>
        <tr>
          <th style="width:60px"></th>
          <th style="width:75px">ÏÑ∏Ï†Ñ</th>
          <th style="width:40px"></th>
          <th>ÏÑ∏ÌõÑ</th>
        </tr>
      </thead>
      <tbody id="tbody">
        <!-- rows are generated by JS -->
      </tbody>
      <tfoot>
        <tr>
          <td>Í≤ÄÏ¶ù</td>
          <td colspan="3" id="totalValue">‚Äî</td>
        </tr>
        <tr>
          <td>Ï¥ùÏÑ∏Í∏à</td>
          <td id="totalTAX">‚Äî</td>
          <td colspan="2"><button id="TAXCalBtn">ÏÑ∏Í∏à Í≥ÑÏÇ∞</button></td>
        </tr>
        <tr>
          <td colspan="2"><button id="resetBtn" style="background-color: red;">Ï¥àÍ∏∞Ìôî</button></td>
          <td></td>
          <td></td>
        </tr>
      </tfoot>
    </table>
  </div>

  <script>
    const names = ["ÏÑúÎπ†", "ÏÑúÎßò", "ÎèÑÎπ†", "ÎèÑÎßò", "ÌòúÎπ†", "ÌòúÎßò", "ÏßÄÎπ†", "ÏßÄÎßò"];
    const tbody = document.getElementById('tbody');
    const totalValueEl = document.getElementById('totalValue');
    const totalTAXEl = document.getElementById('totalTAX');

    function fmt(n){
      if(n === '' || n === null || isNaN(n)) return '';
      return Number(n).toLocaleString();
    }

    function updateTotal(){
      let sum = 0;
      document.querySelectorAll('input[type=number]').forEach(i => {
        const v = parseFloat(i.value);
        if(!isNaN(v)) sum += v;
      });
      totalValueEl.textContent = fmt(sum) || '‚Äî';
    }

    document.querySelectorAll('[data-mult]').forEach(s => s.textContent = '‚Äî');

    function updateTotalTAX(){

      let winners_pretax_sum = 0;
      let posttax_sum = 0;
      
      document.querySelectorAll('input[type=number]').forEach(i => {
        const v = parseFloat(i.value);
        if(!isNaN(v) && v > 0) winners_pretax_sum += v;
      });
      
      document.querySelectorAll('[data-mult]').forEach(s => {
        const v = parseFloat(s.textContent.replace(/,/g, ''));
        if(!isNaN(v)) posttax_sum += v;
      });

      totalTAXEl.textContent = fmt(winners_pretax_sum - posttax_sum) || '‚Äî';
    }

    function update_posttax(){
      names.forEach(name => {
        const target = document.querySelector(`[data-mult="${name}"]`);

        const el = document.querySelector(`input[data-person="${name}"]`);
        const v = el.value
        
        if(v === '' || v === '-' || isNaN(Number(v))) {
          target.textContent = '‚Äî';
        } else {
          if(Number(v) < 0 || Number(v) === 0){
            target.textContent = "-"
          } else {
            const num = calculate_posttax(Number(v));
            target.textContent = fmt(num); 
          }
        }
        
      });
    }

    function calculate_posttax(pretax_income) {
      const bars = [10000, 20000, 30000]
      const rates = [0.15, 0.25, 0.35, 0.45]
      var tax = 0
      if(pretax_income > 1000){
        tax = Math.min(bars[0], pretax_income)*rates[0] + Math.max(Math.min(bars[1], pretax_income) - bars[0], 0) * rates[1] + Math.max(Math.min(bars[2], pretax_income) - bars[1], 0) * rates[2] + Math.max(0, pretax_income - bars[2]) * rates[3]
        tax = Math.floor(tax / 100) * 100;
      }
      return pretax_income - tax;
    }

    function getFirstTwoHangul(str) {
      return str.slice(0, 2);
    }
    
    function find_1st_player() {
      let maxValue = -Infinity;
      let maxTr = null;
    
      document.querySelectorAll('#tbody tr').forEach(tr => {
        const input = tr.querySelector('input[type="number"]');
        const value = parseFloat(input.value);
        const _firstTd = tr.querySelector('td');
        _firstTd.textContent = getFirstTwoHangul(_firstTd.textContent)
        
        if (!isNaN(value) && value > maxValue) {
          maxValue = value;
          maxTr = tr;
        }
      });
    
      if (maxTr) {
        const firstTd = maxTr.querySelector('td');
        firstTd.textContent = `${firstTd.textContent}üëë`;
      }
    }

    names.forEach(name => {
      const tr = document.createElement('tr');

      const tdName = document.createElement('td');
      tdName.textContent = name;

      const tdToggleButton = document.createElement('td');
      const signBtn = document.createElement('button');
      signBtn.textContent = '¬±';
      signBtn.style.padding = '4px 8px';
      tdToggleButton.appendChild(signBtn);
      signBtn.addEventListener('click', () => {
        let v = parseFloat(input.value);
        const target = document.querySelector(`[data-mult="${name}"]`);
        if (!isNaN(v)) {
          input.value = -v;
          target.textContent = "-"
          updateTotal();
          /*
          if(Number(-v) < 0){
            target.textContent = "-"
            updateTotal();
          } else {
            target.textContent = fmt(calculate_posttax(Number(input.value)));
            updateTotal();
          }
          */
        }
      });
      
      const tdInput = document.createElement('td');
      const input = document.createElement('input');
      input.type = 'number';
      input.step = 'any';
      input.min = -999999;
      input.placeholder = 'ÏûÖÎ†•';
      input.value = '';
      input.setAttribute('pattern', '-?[0-9]*');

      input.dataset.person = name;
      tdInput.appendChild(input);
      
      const tdMult = document.createElement('td');
      tdMult.innerHTML = '<span class="mult" data-mult="'+name+'">‚Äî</span>';

      tr.appendChild(tdName);
      tr.appendChild(tdInput);
      tr.appendChild(tdToggleButton);
      tr.appendChild(tdMult);
      tbody.appendChild(tr);

      input.addEventListener('input', (e) => {
        /*
        const v = e.target.value;
        const target = document.querySelector(`[data-mult="${name}"]`);
        
        if(v === '' || v === '-' || isNaN(Number(v))) {
          target.textContent = '‚Äî';
        } else {
          if(Number(v) < 0){
            target.textContent = "-"
          } else {
            const num = calculate_posttax(Number(v));
            target.textContent = fmt(num); 
          }
        }
        */
        updateTotal();
      });
      
      /*
      input.addEventListener('input', (e) => {
        const v = e.target.value;
        const target = document.querySelector(`[data-mult="${name}"]`);
        
        if(v === '' || v === '-' || isNaN(Number(v))) {
          target.textContent = '‚Äî';
        } else {
          if(Number(v) < 0){
            target.textContent = "-"
          } else {
            const num = calculate_posttax(Number(v));
            target.textContent = fmt(num); 
          }
        }
        updateTotal();
      });
      */
      
    });

    document.getElementById('resetBtn').addEventListener('click', () => {
      document.querySelectorAll('input[type=number]').forEach(i => i.value = '');
      document.querySelectorAll('[data-mult]').forEach(s => s.textContent = '‚Äî');
      updateTotal();
      updateTotalTAX();
      find_1st_player();
    });

    document.getElementById('TAXCalBtn').addEventListener('click', () => {
      update_posttax();
      updateTotalTAX();
      find_1st_player();
    });
  </script>
</body>
</html>






























